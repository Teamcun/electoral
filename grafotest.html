<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resultados Electorales - La Paz</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f2f5;
      padding: 20px;
      text-align: center;
    }
    section {
      margin-bottom: 40px;
    }
    canvas {
      max-width: 800px;
      margin: 0 auto;
    }
    h2 {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <h1>Resultados Electorales - Departamento de La Paz</h1>

  <!-- Participación electoral -->
  <section>
    <h2>Participación Electoral</h2>
    <p>Votantes habilitados: <strong>1,200,000</strong><br>
       Votos emitidos: <strong>950,000</strong><br>
       Votos válidos: <strong>920,000</strong> | Nulos: 20,000 | Blancos: 10,000</p>
    <canvas id="graficoParticipacion" height="200"></canvas>
  </section>

  <!-- Diputados plurinominales -->
  <section>
    <h2>Diputados Plurinominales (15 escaños)</h2>
    <canvas id="graficoPlurinominales" height="250"></canvas>
  </section>

  <!-- Senadores -->
  <section>
    <h2>Senadores (4 por La Paz)</h2>
    <canvas id="graficoSenadores" height="200"></canvas>
  </section>

  <!-- Diputados uninominales -->
  <section>
    <h2>Diputados Uninominales (9 circunscripciones)</h2>
    <p>Circunscripciones simuladas y partidos ganadores</p>
    <ul id="listaUninominales" style="text-align: left; display:inline-block;"></ul>
  </section>

  <script>
    // Votos válidos por partido
    const votosPartido = {
      "MAS-IPSP": 350000,
      "LIBRE": 300000,
      "CREEMOS": 200000,
      "FPV": 70000
    };

    const colores = {
      "MAS-IPSP": "#dc3545",
      "LIBRE": "#28a745",
      "CREEMOS": "#007bff",
      "FPV": "#ffc107"
    };

    function aplicarDHondt(votos, escaños) {
      const cocientes = [];
      const asignacion = {};
      for (const partido in votos) {
        asignacion[partido] = 0;
        for (let i = 1; i <= escaños; i++) {
          cocientes.push({ partido, valor: votos[partido] / i });
        }
      }
      cocientes.sort((a, b) => b.valor - a.valor);
      cocientes.slice(0, escaños).forEach(({ partido }) => asignacion[partido]++);
      return asignacion;
    }

    // Asignaciones
    const pluri = aplicarDHondt(votosPartido, 15);
    const senado = aplicarDHondt(votosPartido, 4);

    // Gráfico Participación
    new Chart(document.getElementById("graficoParticipacion"), {
      type: "pie",
      data: {
        labels: ["Votos válidos", "Nulos", "Blancos", "Abstención"],
        datasets: [{
          data: [920000, 20000, 10000, 250000],
          backgroundColor: ["#4caf50", "#ff5722", "#ffc107", "#9e9e9e"]
        }]
      },
      options: {
        plugins: {
          title: {
            display: true,
            text: "Participación Electoral en La Paz"
          }
        }
      }
    });

    // Gráfico Diputados Plurinominales
    new Chart(document.getElementById("graficoPlurinominales"), {
      type: "bar",
      data: {
        labels: Object.keys(pluri),
        datasets: [{
          label: "Diputados asignados",
          data: Object.values(pluri),
          backgroundColor: Object.keys(pluri).map(p => colores[p] || "#888")
        }]
      },
      options: {
        plugins: {
          title: {
            display: true,
            text: "Distribución de Diputados Plurinominales"
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: { stepSize: 1 }
          }
        }
      }
    });

    // Gráfico Senadores
    new Chart(document.getElementById("graficoSenadores"), {
      type: "bar",
      data: {
        labels: Object.keys(senado),
        datasets: [{
          label: "Senadores asignados",
          data: Object.values(senado),
          backgroundColor: Object.keys(senado).map(p => colores[p] || "#888")
        }]
      },
      options: {
        plugins: {
          title: {
            display: true,
            text: "Distribución de Senadores"
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: { stepSize: 1 }
          }
        }
      }
    });

    // Circunscripciones uninominales simuladas (9)
    const circunscripciones = [
      { nombre: "C-1", ganador: "MAS-IPSP" },
      { nombre: "C-2", ganador: "LIBRE" },
      { nombre: "C-3", ganador: "MAS-IPSP" },
      { nombre: "C-4", ganador: "CREEMOS" },
      { nombre: "C-5", ganador: "LIBRE" },
      { nombre: "C-6", ganador: "MAS-IPSP" },
      { nombre: "C-7", ganador: "FPV" },
      { nombre: "C-8", ganador: "LIBRE" },
      { nombre: "C-9", ganador: "CREEMOS" },
    ];

    const lista = document.getElementById("listaUninominales");
    circunscripciones.forEach(c => {
      const li = document.createElement("li");
      li.textContent = `${c.nombre}: Ganó ${c.ganador}`;
      li.style.color = colores[c.ganador] || "#333";
      lista.appendChild(li);
    });
  </script>
</body>
</html>
